{"ast":null,"code":"import _regeneratorRuntime from \"C:\\\\Users\\\\Brian\\\\Projects\\\\SoundWaves\\\\sound-waves\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _asyncToGenerator from \"C:\\\\Users\\\\Brian\\\\Projects\\\\SoundWaves\\\\sound-waves\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"C:\\\\Users\\\\Brian\\\\Projects\\\\SoundWaves\\\\sound-waves\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\Users\\\\Brian\\\\Projects\\\\SoundWaves\\\\sound-waves\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"C:\\\\Users\\\\Brian\\\\Projects\\\\SoundWaves\\\\sound-waves\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"C:\\\\Users\\\\Brian\\\\Projects\\\\SoundWaves\\\\sound-waves\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"C:\\\\Users\\\\Brian\\\\Projects\\\\SoundWaves\\\\sound-waves\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"C:\\\\Users\\\\Brian\\\\Projects\\\\SoundWaves\\\\sound-waves\\\\client\\\\src\\\\components\\\\organisms\\\\AssetsUser.tsx\";\nimport React, { PureComponent } from 'react';\nimport { Link } from 'react-router-dom';\nimport { Logger } from '@oceanprotocol/squid';\nimport { User } from '../../context';\nimport Spinner from '../atoms/Spinner';\nimport AssetTeaser from '../molecules/AssetTeaser';\nimport styles from './AssetsUser.module.scss';\n\nvar AssetsUser =\n/*#__PURE__*/\nfunction (_PureComponent) {\n  _inherits(AssetsUser, _PureComponent);\n\n  function AssetsUser() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, AssetsUser);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(AssetsUser)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      results: [],\n      isLoading: true\n    };\n    _this._isMounted = false;\n    return _this;\n  }\n\n  _createClass(AssetsUser, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this._isMounted = true;\n      this._isMounted && this.searchOcean();\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this._isMounted = false;\n    }\n  }, {\n    key: \"searchOcean\",\n    value: function () {\n      var _searchOcean = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee2() {\n        var _this2 = this;\n\n        var _this$context, account, ocean;\n\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _this$context = this.context, account = _this$context.account, ocean = _this$context.ocean;\n\n                if (account) {\n                  ocean.keeper.didRegistry.contract.getPastEvents('DIDAttributeRegistered', {\n                    filter: {\n                      _owner: account\n                    },\n                    fromBlock: 0,\n                    toBlock: 'latest'\n                  },\n                  /*#__PURE__*/\n                  function () {\n                    var _ref = _asyncToGenerator(\n                    /*#__PURE__*/\n                    _regeneratorRuntime.mark(function _callee(error, events) {\n                      var results, _iteratorNormalCompletion, _didIteratorError, _iteratorError, _iterator, _step, event, ddo;\n\n                      return _regeneratorRuntime.wrap(function _callee$(_context) {\n                        while (1) {\n                          switch (_context.prev = _context.next) {\n                            case 0:\n                              if (!error) {\n                                _context.next = 5;\n                                break;\n                              }\n\n                              Logger.log('error retrieving', error);\n                              _this2._isMounted && _this2.setState({\n                                isLoading: false\n                              });\n                              _context.next = 35;\n                              break;\n\n                            case 5:\n                              results = [];\n                              _iteratorNormalCompletion = true;\n                              _didIteratorError = false;\n                              _iteratorError = undefined;\n                              _context.prev = 9;\n                              _iterator = events[Symbol.iterator]();\n\n                            case 11:\n                              if (_iteratorNormalCompletion = (_step = _iterator.next()).done) {\n                                _context.next = 20;\n                                break;\n                              }\n\n                              event = _step.value;\n                              _context.next = 15;\n                              return ocean.assets.resolve(\"did:op:\".concat(event.returnValues._did.substring(2)));\n\n                            case 15:\n                              ddo = _context.sent;\n                              results.push(ddo);\n\n                            case 17:\n                              _iteratorNormalCompletion = true;\n                              _context.next = 11;\n                              break;\n\n                            case 20:\n                              _context.next = 26;\n                              break;\n\n                            case 22:\n                              _context.prev = 22;\n                              _context.t0 = _context[\"catch\"](9);\n                              _didIteratorError = true;\n                              _iteratorError = _context.t0;\n\n                            case 26:\n                              _context.prev = 26;\n                              _context.prev = 27;\n\n                              if (!_iteratorNormalCompletion && _iterator.return != null) {\n                                _iterator.return();\n                              }\n\n                            case 29:\n                              _context.prev = 29;\n\n                              if (!_didIteratorError) {\n                                _context.next = 32;\n                                break;\n                              }\n\n                              throw _iteratorError;\n\n                            case 32:\n                              return _context.finish(29);\n\n                            case 33:\n                              return _context.finish(26);\n\n                            case 34:\n                              _this2._isMounted && _this2.setState({\n                                results: results,\n                                isLoading: false\n                              });\n\n                            case 35:\n                            case \"end\":\n                              return _context.stop();\n                          }\n                        }\n                      }, _callee, null, [[9, 22, 26, 34], [27,, 29, 33]]);\n                    }));\n\n                    return function (_x, _x2) {\n                      return _ref.apply(this, arguments);\n                    };\n                  }());\n                } else {\n                  this.setState({\n                    isLoading: false\n                  });\n                }\n\n              case 2:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function searchOcean() {\n        return _searchOcean.apply(this, arguments);\n      }\n\n      return searchOcean;\n    }()\n  }, {\n    key: \"render\",\n    value: function render() {\n      var account = this.context.account;\n      var _this$props = this.props,\n          recent = _this$props.recent,\n          list = _this$props.list;\n      var _this$state = this.state,\n          isLoading = _this$state.isLoading,\n          results = _this$state.results;\n      if (!account) return null;\n      return React.createElement(\"div\", {\n        className: styles.assetsUser,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 69\n        },\n        __self: this\n      }, this.props.recent && React.createElement(\"h2\", {\n        className: styles.subTitle,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 71\n        },\n        __self: this\n      }, \"Your latest published papers\"), isLoading ? React.createElement(Spinner, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 77\n        },\n        __self: this\n      }) : results.length ? React.createElement(React.Fragment, null, results.slice(0, recent || undefined).filter(function (asset) {\n        return !!asset;\n      }).map(function (asset) {\n        return React.createElement(AssetTeaser, {\n          list: list,\n          key: asset.id,\n          asset: asset,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 84\n          },\n          __self: this\n        });\n      }), recent && React.createElement(Link, {\n        className: styles.link,\n        to: \"/history\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 91\n        },\n        __self: this\n      }, \"All Research Papers\")) : React.createElement(\"div\", {\n        className: styles.empty,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 97\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 98\n        },\n        __self: this\n      }, \"No Research Papers Yet.\"), React.createElement(Link, {\n        to: \"/publish\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 99\n        },\n        __self: this\n      }, \"+ Publish A Research Paper\")));\n    }\n  }]);\n\n  return AssetsUser;\n}(PureComponent);\n\nAssetsUser.contextType = User;\nexport { AssetsUser as default };","map":{"version":3,"sources":["C:/Users/Brian/Projects/SoundWaves/sound-waves/client/src/components/organisms/AssetsUser.tsx"],"names":["React","PureComponent","Link","Logger","User","Spinner","AssetTeaser","styles","AssetsUser","state","results","isLoading","_isMounted","searchOcean","context","account","ocean","keeper","didRegistry","contract","getPastEvents","filter","_owner","fromBlock","toBlock","error","events","log","setState","event","assets","resolve","returnValues","_did","substring","ddo","push","props","recent","list","assetsUser","subTitle","length","slice","undefined","asset","map","id","link","empty","contextType"],"mappings":"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","sourcesContent":["import React, { PureComponent } from 'react'\r\nimport { Link } from 'react-router-dom'\r\nimport { Logger } from '@oceanprotocol/squid'\r\nimport { User } from '../../context'\r\nimport Spinner from '../atoms/Spinner'\r\nimport AssetTeaser from '../molecules/AssetTeaser'\r\nimport styles from './AssetsUser.module.scss'\r\n\r\nexport default class AssetsUser extends PureComponent<\r\n    { list?: boolean; recent?: number },\r\n    { results: any[]; isLoading: boolean }\r\n> {\r\n    public static contextType = User\r\n\r\n    public state = { results: [], isLoading: true }\r\n\r\n    public _isMounted = false\r\n\r\n    public componentDidMount() {\r\n        this._isMounted = true\r\n        this._isMounted && this.searchOcean()\r\n    }\r\n\r\n    public componentWillUnmount() {\r\n        this._isMounted = false\r\n    }\r\n\r\n    private async searchOcean() {\r\n        const { account, ocean } = this.context\r\n\r\n        if (account) {\r\n            ocean.keeper.didRegistry.contract.getPastEvents(\r\n                'DIDAttributeRegistered',\r\n                {\r\n                    filter: { _owner: account },\r\n                    fromBlock: 0,\r\n                    toBlock: 'latest'\r\n                },\r\n                async (error: any, events: any) => {\r\n                    if (error) {\r\n                        Logger.log('error retrieving', error)\r\n                        this._isMounted && this.setState({ isLoading: false })\r\n                    } else {\r\n                        const results = []\r\n                        for (const event of events) {\r\n                            const ddo = await ocean.assets.resolve(\r\n                                `did:op:${event.returnValues._did.substring(2)}`\r\n                            )\r\n                            results.push(ddo)\r\n                        }\r\n                        this._isMounted &&\r\n                            this.setState({ results, isLoading: false })\r\n                    }\r\n                }\r\n            )\r\n        } else {\r\n            this.setState({ isLoading: false })\r\n        }\r\n    }\r\n\r\n    public render() {\r\n        const { account } = this.context\r\n        const { recent, list } = this.props\r\n        const { isLoading, results } = this.state\r\n\r\n        if (!account) return null\r\n\r\n        return (\r\n            <div className={styles.assetsUser}>\r\n                {this.props.recent && (\r\n                    <h2 className={styles.subTitle}>\r\n                        Your latest published papers\r\n                    </h2>\r\n                )}\r\n\r\n                {isLoading ? (\r\n                    <Spinner />\r\n                ) : results.length ? (\r\n                    <>\r\n                        {results\r\n                            .slice(0, recent || undefined)\r\n                            .filter(asset => !!asset)\r\n                            .map((asset: any) => (\r\n                                <AssetTeaser\r\n                                    list={list}\r\n                                    key={asset.id}\r\n                                    asset={asset}\r\n                                />\r\n                            ))}\r\n                        {recent && (\r\n                            <Link className={styles.link} to=\"/history\">\r\n                                All Research Papers\r\n                            </Link>\r\n                        )}\r\n                    </>\r\n                ) : (\r\n                    <div className={styles.empty}>\r\n                        <p>No Research Papers Yet.</p>\r\n                        <Link to=\"/publish\">+ Publish A Research Paper</Link>\r\n                    </div>\r\n                )}\r\n            </div>\r\n        )\r\n    }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}