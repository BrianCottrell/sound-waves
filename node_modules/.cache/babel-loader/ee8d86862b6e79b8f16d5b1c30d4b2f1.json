{"ast":null,"code":"import _regeneratorRuntime from \"C:\\\\Users\\\\Brian\\\\Projects\\\\ResearchHub\\\\research-hub\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _defineProperty from \"C:\\\\Users\\\\Brian\\\\Projects\\\\ResearchHub\\\\research-hub\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";\nimport _asyncToGenerator from \"C:\\\\Users\\\\Brian\\\\Projects\\\\ResearchHub\\\\research-hub\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"C:\\\\Users\\\\Brian\\\\Projects\\\\ResearchHub\\\\research-hub\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\Users\\\\Brian\\\\Projects\\\\ResearchHub\\\\research-hub\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"C:\\\\Users\\\\Brian\\\\Projects\\\\ResearchHub\\\\research-hub\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"C:\\\\Users\\\\Brian\\\\Projects\\\\ResearchHub\\\\research-hub\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"C:\\\\Users\\\\Brian\\\\Projects\\\\ResearchHub\\\\research-hub\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"C:\\\\Users\\\\Brian\\\\Projects\\\\ResearchHub\\\\research-hub\\\\client\\\\src\\\\routes\\\\Search.tsx\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { PureComponent } from 'react';\nimport { Link } from 'react-router-dom';\nimport queryString from 'query-string';\nimport { Logger } from '@oceanprotocol/squid';\nimport Spinner from '../components/atoms/Spinner';\nimport Route from '../components/templates/Route';\nimport { User } from '../context';\nimport AssetTeaser from '../components/molecules/AssetTeaser';\nimport Pagination from '../components/molecules/Pagination';\nimport styles from './Search.module.scss';\nimport Content from '../components/atoms/Content';\nimport withTracker from '../hoc/withTracker';\n\nvar Search =\n/*#__PURE__*/\nfunction (_PureComponent) {\n  _inherits(Search, _PureComponent);\n\n  function Search() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, Search);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Search)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      results: [],\n      totalResults: 0,\n      offset: 25,\n      totalPages: 1,\n      currentPage: 1,\n      isLoading: true,\n      searchTerm: '',\n      searchCategories: ''\n    };\n    _this.searchAssets =\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee() {\n      var ocean, _this$state, offset, currentPage, searchTerm, searchCategories, queryValues, searchQuery, search;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              ocean = _this.context.ocean;\n              _this$state = _this.state, offset = _this$state.offset, currentPage = _this$state.currentPage, searchTerm = _this$state.searchTerm;\n              searchCategories = 'Research';\n              queryValues = searchTerm !== '' ? {\n                text: [searchTerm],\n                categories: [searchCategories]\n              } : searchTerm === '' ? {\n                categories: [searchCategories]\n              } : {\n                text: [searchTerm]\n              };\n              searchQuery = {\n                offset: offset,\n                page: currentPage,\n                query: _objectSpread({}, queryValues),\n                sort: {\n                  created: -1\n                }\n              };\n              _context.prev = 5;\n              _context.next = 8;\n              return ocean.assets.query(searchQuery);\n\n            case 8:\n              search = _context.sent;\n\n              _this.setState({\n                results: search.results,\n                totalResults: search.totalResults,\n                totalPages: search.totalPages,\n                isLoading: false\n              });\n\n              _context.next = 16;\n              break;\n\n            case 12:\n              _context.prev = 12;\n              _context.t0 = _context[\"catch\"](5);\n              Logger.error(_context.t0.message);\n\n              _this.setState({\n                isLoading: false\n              });\n\n            case 16:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[5, 12]]);\n    }));\n\n    _this.handlePageClick =\n    /*#__PURE__*/\n    function () {\n      var _ref2 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee2(data) {\n        var toPage;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                // react-pagination starts counting at 0, we start at 1\n                toPage = data.selected + 1;\n\n                _this.props.history.push({\n                  pathname: _this.props.location.pathname,\n                  search: \"?text=\".concat(_this.state.searchTerm, \"&page=\").concat(toPage)\n                });\n\n                _context2.next = 4;\n                return _this.setState({\n                  currentPage: toPage,\n                  isLoading: true\n                });\n\n              case 4:\n                _context2.next = 6;\n                return _this.searchAssets();\n\n              case 6:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2);\n      }));\n\n      return function (_x) {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n\n    _this.renderResults = function () {\n      return _this.state.isLoading ? React.createElement(Spinner, {\n        message: \"Searching...\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 120\n        },\n        __self: this\n      }) : _this.state.results && _this.state.results.length ? React.createElement(\"div\", {\n        className: styles.results,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 122\n        },\n        __self: this\n      }, _this.state.results.map(function (asset) {\n        return React.createElement(AssetTeaser, {\n          key: asset.id,\n          asset: asset,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 123\n          },\n          __self: this\n        });\n      })) : React.createElement(\"div\", {\n        className: styles.empty,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 126\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 127\n        },\n        __self: this\n      }, \"No Research Papers Found.\"), React.createElement(Link, {\n        to: \"/publish\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 128\n        },\n        __self: this\n      }, \"+ Publish A Research Paper\"));\n    };\n\n    return _this;\n  }\n\n  _createClass(Search, [{\n    key: \"componentDidMount\",\n    value: function () {\n      var _componentDidMount = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee3() {\n        var search, _queryString$parse, text, page, categories, currentPage;\n\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                search = this.props.location.search;\n                _queryString$parse = queryString.parse(search), text = _queryString$parse.text, page = _queryString$parse.page, categories = _queryString$parse.categories;\n\n                if (!text) {\n                  _context3.next = 5;\n                  break;\n                }\n\n                _context3.next = 5;\n                return this.setState({\n                  searchTerm: decodeURIComponent(\"\".concat(text))\n                });\n\n              case 5:\n                if (!categories) {\n                  _context3.next = 8;\n                  break;\n                }\n\n                _context3.next = 8;\n                return this.setState({\n                  searchCategories: decodeURIComponent(\"\".concat(categories))\n                });\n\n              case 8:\n                if (!page) {\n                  _context3.next = 12;\n                  break;\n                }\n\n                currentPage = Number(page);\n                _context3.next = 12;\n                return this.setState({\n                  currentPage: currentPage\n                });\n\n              case 12:\n                this.searchAssets();\n\n              case 13:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function componentDidMount() {\n        return _componentDidMount.apply(this, arguments);\n      }\n\n      return componentDidMount;\n    }()\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$state2 = this.state,\n          totalResults = _this$state2.totalResults,\n          totalPages = _this$state2.totalPages,\n          currentPage = _this$state2.currentPage;\n      return React.createElement(Route, {\n        title: \"Search\",\n        wide: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 136\n        },\n        __self: this\n      }, React.createElement(Content, {\n        wide: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 137\n        },\n        __self: this\n      }, !this.state.isLoading && React.createElement(\"h2\", {\n        className: styles.resultsTitle,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 139\n        },\n        __self: this\n      }, totalResults, \" results for\", ' ', React.createElement(\"span\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 141\n        },\n        __self: this\n      }, decodeURIComponent(this.state.searchTerm || this.state.searchCategories))), this.renderResults(), React.createElement(Pagination, {\n        totalPages: totalPages,\n        currentPage: currentPage,\n        handlePageClick: this.handlePageClick,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 146\n        },\n        __self: this\n      })));\n    }\n  }]);\n\n  return Search;\n}(PureComponent);\n\nSearch.contextType = User;\nexport default withTracker(Search);","map":{"version":3,"sources":["C:/Users/Brian/Projects/ResearchHub/research-hub/client/src/routes/Search.tsx"],"names":["React","PureComponent","Link","queryString","Logger","Spinner","Route","User","AssetTeaser","Pagination","styles","Content","withTracker","Search","state","results","totalResults","offset","totalPages","currentPage","isLoading","searchTerm","searchCategories","searchAssets","ocean","context","queryValues","text","categories","searchQuery","page","query","sort","created","assets","search","setState","error","message","handlePageClick","data","toPage","selected","props","history","push","pathname","location","renderResults","length","map","asset","id","empty","parse","decodeURIComponent","Number","resultsTitle","contextType"],"mappings":"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","sourcesContent":["import React, { PureComponent } from 'react';\r\nimport { Link } from 'react-router-dom';\r\nimport queryString from 'query-string';\r\nimport { History, Location } from 'history';\r\nimport { Logger } from '@oceanprotocol/squid';\r\nimport Spinner from '../components/atoms/Spinner';\r\nimport Route from '../components/templates/Route';\r\nimport { User } from '../context';\r\nimport AssetTeaser from '../components/molecules/AssetTeaser';\r\nimport Pagination from '../components/molecules/Pagination';\r\nimport styles from './Search.module.scss';\r\nimport Content from '../components/atoms/Content';\r\nimport withTracker from '../hoc/withTracker';\r\n\r\ninterface SearchProps {\r\n\tlocation: Location;\r\n\thistory: History;\r\n}\r\n\r\ninterface SearchState {\r\n\tresults: any[];\r\n\ttotalResults: number;\r\n\toffset: number;\r\n\ttotalPages: number;\r\n\tcurrentPage: number;\r\n\tisLoading: boolean;\r\n\tsearchTerm: string;\r\n\tsearchCategories: string;\r\n}\r\n\r\nclass Search extends PureComponent<SearchProps, SearchState> {\r\n\tpublic static contextType = User;\r\n\r\n\tpublic state = {\r\n\t\tresults: [],\r\n\t\ttotalResults: 0,\r\n\t\toffset: 25,\r\n\t\ttotalPages: 1,\r\n\t\tcurrentPage: 1,\r\n\t\tisLoading: true,\r\n\t\tsearchTerm: '',\r\n\t\tsearchCategories: ''\r\n\t};\r\n\r\n\tpublic async componentDidMount() {\r\n\t\tconst { search } = this.props.location;\r\n\t\tconst { text, page, categories } = queryString.parse(search);\r\n\r\n\t\tif (text) {\r\n\t\t\tawait this.setState({\r\n\t\t\t\tsearchTerm: decodeURIComponent(`${text}`)\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tif (categories) {\r\n\t\t\tawait this.setState({\r\n\t\t\t\tsearchCategories: decodeURIComponent(`${categories}`)\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\t// switch to respective page if query string is present\r\n\t\tif (page) {\r\n\t\t\tconst currentPage = Number(page);\r\n\t\t\tawait this.setState({ currentPage });\r\n\t\t}\r\n\r\n\t\tthis.searchAssets();\r\n\t}\r\n\r\n\tprivate searchAssets = async () => {\r\n\t\tconst { ocean } = this.context;\r\n\t\tconst { offset, currentPage, searchTerm } = this.state;\r\n\t\tconst searchCategories = 'Research';\r\n\r\n\t\tconst queryValues =\r\n\t\t\tsearchTerm !== ''\r\n\t\t\t\t? { text: [ searchTerm ], categories: [ searchCategories ] }\r\n\t\t\t\t: searchTerm === '' ? { categories: [ searchCategories ] } : { text: [ searchTerm ] };\r\n\r\n\t\tconst searchQuery = {\r\n\t\t\toffset,\r\n\t\t\tpage: currentPage,\r\n\t\t\tquery: {\r\n\t\t\t\t...queryValues\r\n\t\t\t},\r\n\t\t\tsort: {\r\n\t\t\t\tcreated: -1\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\ttry {\r\n\t\t\tconst search = await ocean.assets.query(searchQuery);\r\n\t\t\tthis.setState({\r\n\t\t\t\tresults: search.results,\r\n\t\t\t\ttotalResults: search.totalResults,\r\n\t\t\t\ttotalPages: search.totalPages,\r\n\t\t\t\tisLoading: false\r\n\t\t\t});\r\n\t\t} catch (error) {\r\n\t\t\tLogger.error(error.message);\r\n\t\t\tthis.setState({ isLoading: false });\r\n\t\t}\r\n\t};\r\n\r\n\tprivate handlePageClick = async (data: { selected: number }) => {\r\n\t\t// react-pagination starts counting at 0, we start at 1\r\n\t\tconst toPage = data.selected + 1;\r\n\r\n\t\tthis.props.history.push({\r\n\t\t\tpathname: this.props.location.pathname,\r\n\t\t\tsearch: `?text=${this.state.searchTerm}&page=${toPage}`\r\n\t\t});\r\n\r\n\t\tawait this.setState({ currentPage: toPage, isLoading: true });\r\n\t\tawait this.searchAssets();\r\n\t};\r\n\r\n\tpublic renderResults = () =>\r\n\t\tthis.state.isLoading ? (\r\n\t\t\t<Spinner message=\"Searching...\" />\r\n\t\t) : this.state.results && this.state.results.length ? (\r\n\t\t\t<div className={styles.results}>\r\n\t\t\t\t{this.state.results.map((asset: any) => <AssetTeaser key={asset.id} asset={asset} />)}\r\n\t\t\t</div>\r\n\t\t) : (\r\n\t\t\t<div className={styles.empty}>\r\n\t\t\t\t<p>No Research Papers Found.</p>\r\n\t\t\t\t<Link to=\"/publish\">+ Publish A Research Paper</Link>\r\n\t\t\t</div>\r\n\t\t);\r\n\r\n\tpublic render() {\r\n\t\tconst { totalResults, totalPages, currentPage } = this.state;\r\n\r\n\t\treturn (\r\n\t\t\t<Route title=\"Search\" wide>\r\n\t\t\t\t<Content wide>\r\n\t\t\t\t\t{!this.state.isLoading && (\r\n\t\t\t\t\t\t<h2 className={styles.resultsTitle}>\r\n\t\t\t\t\t\t\t{totalResults} results for{' '}\r\n\t\t\t\t\t\t\t<span>{decodeURIComponent(this.state.searchTerm || this.state.searchCategories)}</span>\r\n\t\t\t\t\t\t</h2>\r\n\t\t\t\t\t)}\r\n\t\t\t\t\t{this.renderResults()}\r\n\r\n\t\t\t\t\t<Pagination\r\n\t\t\t\t\t\ttotalPages={totalPages}\r\n\t\t\t\t\t\tcurrentPage={currentPage}\r\n\t\t\t\t\t\thandlePageClick={this.handlePageClick}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Content>\r\n\t\t\t</Route>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default withTracker(Search);\r\n"]},"metadata":{},"sourceType":"module"}